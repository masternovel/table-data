/* Fuel Price Script v1.4 - Mobile Optimized */
!function(){"use strict";
if("undefined"==typeof CFG)return void console.error("CFG configuration not found.");
const{state:e,city:t,stateSlug:a,citySlug:n,fuelType:r,fuelLabel:o,capitalCity:s}=CFG,i={},
/* Mobile detection */
v=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent),
l=e=>i[e]||(i[e]=fetch(e).then(e=>e.json())),
c=e=>{const t=e.options[e.selectedIndex].dataset.url;t&&"#"!==t&&(location.href=t)},
d=e=>{const t=new Date(e);return`${months[t.getMonth()]} ${String(t.getDate()).padStart(2,"0")}, ${t.getFullYear()}`},
u=e=>({arrow:e>0?"▲":e<0?"▼":"▪",color:e>0?"red":e<0?"green":"black"}),
p=(e,t,a=!0)=>{const n=document.getElementById(e);n&&("string"==typeof t?n.innerHTML=t:n.textContent=t,a&&n.classList.remove("fuel-placeholder"))};
window.addEventListener("pageshow",a=>{if(a.persisted||2===window.performance?.navigation.type){const a=document.getElementById("stateSelect"),n=document.getElementById("citySelect");a&&(a.value=e),n&&(n.value=t)}},{passive:!0});
const m=e=>{requestIdleCallback(()=>{document.querySelectorAll('script[type="application/ld+json"]').forEach(e=>{e.id&&"frisqoo-custom-schema"===e.id||e.remove()});const a=location.href,n={"@type":"Organization",name:"Frisqoo",url:"https://www.frisqoo.com/"};let r="";if(e?.length>1){const t=new Date(e[e.length-1][0]).toISOString().split("T")[0],a=new Date().toISOString().split("T")[0];r=`${t}/${a}`}const s={"\u0040context":"https://schema.org","\u0040graph":[{"\u0040type":"WebPage","\u0040id":`${a}#webpage`,name:`${o} Price in ${t} - Today (${currentDate})`,url:a,description:`Get the latest ${o.toLowerCase()} price in ${t} for ${currentDate}. This page provides a complete daily price update, a 10-day historical price trend, a state-wide price comparison, and answers to frequently asked questions.`,mainEntity:{"\u0040id":`${a}#dataset`}},{"\u0040type":"Dataset","\u0040id":`${a}#dataset`,mainEntityOfPage:{"\u0040id":`${a}#webpage`},name:`Daily ${o} Price History and Today's Rate for ${t}`,description:`A 10-day price history dataset for ${o.toLowerCase()} in ${t}, ${e}.`,keywords:[`${o} price in ${t}`,`today ${o.toLowerCase()} rate ${t}`,`${t} ${o.toLowerCase()} price`,"fuel price","daily price update"],license:"https://creativecommons.org/licenses/by/4.0/",spatialCoverage:{"\u0040type":"Place",name:`${t}, ${e}`},temporalCoverage:r,creator:n,provider:n},{"\u0040type":"FAQPage",mainEntity:Array.from(document.querySelectorAll(".showH > details")).map(e=>({"\u0040type":"Question",name:e.querySelector("summary").textContent,acceptedAnswer:{"\u0040type":"Answer",text:e.querySelector(".aC p").innerHTML}}))}]},i=document.createElement("script");i.type="application/ld+json",i.id="frisqoo-custom-schema",i.text=JSON.stringify(s),document.head.appendChild(i)},{timeout:v?8e3:5e3})},
f=n=>{if(!n||n.length<2||!s){const e=document.getElementById("faqComparisonDetails");return void(e&&(e.style.display="none"))}let a="N/A",i="N/A",l={price:1/0,cities:[]},c={price:-1/0,cities:[]};for(let e=1;e<n.length;e++){const o=n[e],[d,u]=o,p=parseFloat(String(u).replace(/[^0-9.-]/g,""));d===t&&(a=u),d===s&&(i=u),isNaN(p)||(p<l.price?l={price:p,cities:[d]}:p===l.price&&l.cities.push(d),p>c.price?c={price:p,cities:[d]}:p===c.price&&c.cities.push(d))}const d=t===s?`As the state capital, this price serves as a key benchmark for other cities in ${e}.`:`For comparison, the price in the state capital <strong>${s}</strong> is <strong>${i}</strong>.`;p("faqComparisonAnswer",`In <strong>${t}</strong>, today's ${o.toLowerCase()} price is <strong>${a}</strong>. ${d}<br><br>Currently, the cheapest ${o.toLowerCase()} in ${e} is <strong>₹${l.price.toFixed(2)}</strong> in ${l.cities.join(" and ")}, while the most expensive is <strong>₹${c.price.toFixed(2)}</strong> in ${c.cities.join(" and ")}.<br><br>For a full city-by-city breakdown, <strong><a href="https://www.frisqoo.com/p/${r}-price-in-${a}.html">view the complete ${e} ${o} price list</a></strong>.`,!1)},
h=async()=>{try{
const[g,h]=await Promise.all([
l(`https://cdn.frisqoo.com/${r}/${a}/${n}.json`),
l(`https://cdn.frisqoo.com/${r}/${a}.json`)
]);
const b=h.find((e,a)=>a>0&&e[0].trim().toLowerCase()===t.trim().toLowerCase());
if(b){
const[,a,n]=b,r=parseFloat(n.replace(/[^0-9.-]/g,"")),{arrow:s,color:i}=u(r);
p("paraPrice",a);
p("petrolPriceValue",`<span style="font-size:19px;font-weight:bold">${a}</span> <span style="font-size:14px">/ltr</span><span style="font-size:14px">(₹${Math.abs(r).toFixed(2)} <span style="font-weight:bold;color:${i}">${s}</span>)</span>`,!1);
p("petrolPriceFAQ",`The ${o.toLowerCase()} price in ${t} is <strong>${a}</strong> per litre. Prices are updated daily at 6:00 AM IST.`,!1);
const l=r>0?`has <strong style="color:red;">increased</strong> by ₹${Math.abs(r).toFixed(2)} since yesterday.`:r<0?`has <strong style="color:green;">decreased</strong> by ₹${Math.abs(r).toFixed(2)} since yesterday.`:`has <strong style="color:black;">remained the same</strong> compared to yesterday.`;
p("faqTrendAnswer",`Compared to yesterday, the ${o.toLowerCase()} price in <strong>${t}</strong> ${l}`,!1);
}
setTimeout(()=>{
const e=document.querySelector("#dataTable tbody");
if(g?.length>1){
const a=g.slice(1);
let n=0;
const r=v?2:3;
const s=()=>{
if(n>=a.length)return;
const i=a.slice(n,n+r),l=document.createDocumentFragment(),c=document.createElement("template");
c.innerHTML=i.map(e=>{const t=parseFloat(String(e[2]).replace(/[^0-9.-]/g,"")),{arrow:a,color:n}=u(t);return`<tr><td>${d(e[0])}</td><td>${e[1]}</td><td>${e[2]} <span style="font-weight:bold;color:${n}">${a}</span></td></tr>`}).join("");
l.appendChild(c.content);
0===n&&(e.innerHTML="");
e.appendChild(l);
n+=r;
n<a.length&&setTimeout(s,v?10:0);
};
s();
p("faqYesterdayAnswer",`Yesterday, on <strong>${d(g[1][0])}</strong>, the ${o.toLowerCase()} price in <strong>${t}</strong> was <strong>${g[1][1]}</strong> per litre.`,!1);
}else e.innerHTML='<tr><td colspan="3" style="text-align:center!important;padding:20px;">Price history is currently unavailable.</td></tr>';
},0);
requestIdleCallback(()=>{
Promise.all([
l(`https://cdn.frisqoo.com/utilities/${r}/states.json`),
l(`https://cdn.frisqoo.com/utilities/${r}/${a}.json`)
]).then(([a,n])=>{
const r=document.getElementById("stateSelect"),s=document.getElementById("citySelect");
let i=0;
const o=v?15:25;
const h=()=>{
if(i>=a.length)return;
const n=a.slice(i,i+o);
r.innerHTML+=n.map(a=>`<option value="${a.name}" data-url="${a.url}"${a.name===e?" selected":""}>${a.name}</option>`).join("");
i+=o;
i<a.length&&setTimeout(h,v?20:10);
};
h();
s.innerHTML=n.map(e=>`<option value="${e.name}" data-url="${e.url}"${e.name===t?" selected":""}>${e.name}</option>`).join("");
r.addEventListener("change",(function(){c(this)}),{passive:!0});
s.addEventListener("change",(function(){c(this)}),{passive:!0});
});
},{timeout:v?2e3:1e3});
requestIdleCallback(()=>{
if(g?.length>1&&"undefined"!=typeof Chart){
const e=g.slice(1).reverse();
b&&e.push([new Date().toISOString(),b[1],b[2]||"₹0.00"]);
const a=e.map(e=>d(e[0]).split(",")[0]),n=e.map(e=>parseFloat(String(e[1]).replace(/[^0-9.]/g,"")));
new Chart(document.getElementById("priceChart"),{type:"line",data:{labels:a,datasets:[{label:`${o} Price (₹/ltr)`,data:n,borderColor:"#4a90e2",backgroundColor:"rgba(74,144,226,0.1)",borderWidth:2,pointRadius:v?3:4,pointBackgroundColor:"#4a90e2",pointBorderColor:"#fff",pointBorderWidth:v?1:2,tension:.3,fill:!0}]},options:{responsive:!0,maintainAspectRatio:!1,animation:{duration:v?500:750},plugins:{legend:{display:!0,position:"top",labels:{font:{size:12},color:document.body.classList.contains("drK")?"#e0e0e0":"#333"}},tooltip:{backgroundColor:"rgba(0,0,0,0.8)",titleColor:"#fff",bodyColor:"#fff",borderColor:"#4a90e2",borderWidth:1,padding:10,displayColors:!1,callbacks:{label:function(e){return`Price: ₹${e.parsed.y.toFixed(2)}/ltr`}}}},scales:{x:{grid:{display:!1},ticks:{font:{size:11},color:document.body.classList.contains("drK")?"#b0b0b0":"#666"}},y:{beginAtZero:!1,grid:{color:document.body.classList.contains("drK")?"rgba(255,255,255,0.1)":"rgba(0,0,0,0.05)"},ticks:{font:{size:11},color:document.body.classList.contains("drK")?"#b0b0b0":"#666",callback:function(e){return`₹${e.toFixed(2)}`}}}}}});
}
f(h);
m(g);
},{timeout:v?5e3:3e3});
}catch(e){console.error("Init error:",e)}
requestIdleCallback(()=>{const e=document.querySelector(".pTtl > span");if(e){const t=e.innerText.split(" - Today")[0];e.innerHTML=`${t} - Today <span style="font-size:18px">(${currentDate})</span>`}l("https://www.frisqoo.com/feeds/posts/summary/-/Fuel?alt=json&max-results=5").then(e=>{const t=(e.feed?.entry||[]).map((e,t)=>`<p style="display:flex;align-items:center;margin:0"><span>${t+1}. </span><a href="${e.link.find(e=>"alternate"===e.rel).href}" target="_blank" style="margin-left:5px">${e.title.$t}</a></p>`).join(""),a=document.getElementById("related-posts");a&&(a.innerHTML=t)}).catch(()=>{})},{timeout:v?10e3:7e3})};
"loading"===document.readyState?document.addEventListener("DOMContentLoaded",h):h();
document.addEventListener("DOMContentLoaded",()=>{document.querySelectorAll('input[type=radio][name="fuelType"]').forEach(e=>{e.addEventListener("change",()=>{const t=e.nextElementSibling?.querySelector("a");t&&t.click()},{passive:!0})})});
}();
